#pragma once
#include <cmath>
#include <vector>
#include <array>
#include "Point.h"

enum eCretType
{
	CRET_NONE = 0,
	CRET_PLAYER = 1,
	CRET_NPC = 2,
	CRET_MONSTER = 3,
	CRET_PET = 4,
	CRET_ITEM = 5,
	CRET_MAGIC = 6,
	CRET_ROBOT = 7,
	CRET_COUNT,
};

inline const char* to_string(eCretType e)
{
	switch (e)
	{
	case CRET_NONE: return "CRET_NONE";
	case CRET_PLAYER: return "玩家";
	case CRET_NPC: return "CRET_NPC";
	case CRET_MONSTER: return "怪物";
	case CRET_PET: return "宠物";
	case CRET_ITEM: return "物品";
	case CRET_MAGIC: return "魔法";
	case CRET_ROBOT: return "机器人";
	case CRET_COUNT: return "CRET_ALL";
	default: return "unknown";
	}
}
inline const std::vector<std::pair<int, int>> commonAoi = { {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0} ,{1,1} };

inline const std::vector<Point> SpiralPoints = []()
	{
		constexpr int size = 32;
		std::vector<Point> points;
		int dx[] = { 1, 0, -1, 0 };  // 右 → 下 → 左 → 上
		int dy[] = { 0, 1, 0, -1 };
		int x = 0, y = 0, dir = 0, steps = 1;

		points.emplace_back(x, y);  // 中心点

		for (int layer = 1; layer <= size / 2; layer++) {
			for (int i = 0; i < 2; i++) {  // 每个方向走两次
				for (int s = 0; s < steps; s++) {
					x += dx[dir];
					y += dy[dir];
					if (std::abs(x) <= layer && std::abs(y) <= layer) {
						points.emplace_back(x, y);
					}
				}
				dir = (dir + 1) % 4;  // 转向
			}
			steps++;  // 每层增加步长
		}
		return points;
	}();
	
inline const std::vector<Point> MonSpiralPoints = []() 
	{
		std::vector<Point> path;
		constexpr int layers = 5;	//最大 6+n*12 的挂机半径，中心区域不算层数

		// 第0层：中心点 (0,0)
		path.emplace_back(0, 0);

		// 从第1圈开始生成（n=1对应第1圈）
		for (int n = 1; n <= layers; ++n) {
			// 1. 向下：从(n, n-1)到(n, -n)
			for (int y = n - 1; y >= -n; --y) {
				path.emplace_back(n, y);
			}

			// 2. 向左：从(n-1, -n)到(-n, -n)
			for (int x = n - 1; x >= -n; --x) {
				path.emplace_back(x, -n);
			}

			// 3. 向上：从(-n, -n+1)到(-n, n)
			for (int y = -n + 1; y <= n; ++y) {
				path.emplace_back(-n, y);
			}

			// 4. 向右：从(-n+1, n)到(n, n)
			for (int x = -n + 1; x <= n; ++x) {
				path.emplace_back(x, n);
			}
		}

		return path; 
	}();


// AOI九宫格数组（25种索引）0进入视野，1离开视野，2在视野内
const std::array<std::array<std::vector<std::pair<int, int>>, 3>, 25> sAoiArray = { {
		// 索引0 
		{{
			{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0} }},
			{{ {1,2}, {1,3}, {2,1}, {2,2}, {2,3}, {3,1}, {3,2}, {3,3} }},
			{{ {1,1} }}
		}},

	// 索引1 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {1,-1}, {1,0} }},
		{{ {0,2}, {0,3}, {1,2}, {1,3}, {2,1}, {2,2}, {2,3} }},
		{{ {0,1}, {1,1} }}
	}},

	// 索引2 
	{{
		{{ {-1,-1}, {-1,0}, {0,-1}, {0,0}, {1,-1}, {1,0} }},
		{{ {-1,2}, {-1,3}, {0,2}, {0,3}, {1,2}, {1,3} }},
		{{ {-1,1}, {0,1}, {1,1} }}
	}},

	// 索引3 
	{{
		{{ {-1,-1}, {-1,0}, {0,-1}, {0,0}, {1,-1}, {1,0}, {1,1} }},
		{{ {-2,1}, {-2,2}, {-2,3}, {-1,2}, {-1,3}, {0,2}, {0,3} }},
		{{ {-1,1}, {0,1} }}
	}},

	// 索引4 
	{{
		{{ {-1,-1}, {-1,0}, {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-3,1}, {-3,2}, {-3,3}, {-2,1}, {-2,2}, {-2,3}, {-1,2}, {-1,3} }},
		{{ {-1,1} }}
	}},

	// 索引5 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,-1} }},
		{{ {1,2}, {2,0}, {2,1}, {2,2}, {3,0}, {3,1}, {3,2} }},
		{{ {1,0}, {1,1} }}
	}},

	// 索引6 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {1,-1} }},
		{{ {0,2}, {1,2}, {2,0}, {2,1}, {2,2} }},
		{{ {0,0}, {0,1}, {1,0}, {1,1} }}
	}},

	// 索引7 
	{{
		{{ {-1,-1}, {0,-1}, {1,-1} }},
		{{ {-1,2}, {0,2}, {1,2} }},
		{{ {-1,0}, {-1,1}, {0,0}, {0,1}, {1,0}, {1,1} }}
	}},

	// 索引8 
	{{
		{{ {-1,-1}, {0,-1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-2,0}, {-2,1}, {-2,2}, {-1,2}, {0,2} }},
		{{ {-1,0}, {-1,1}, {0,0}, {0,1} }}
	}},

	// 索引9 
	{{
		{{ {-1,-1}, {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-3,0}, {-3,1}, {-3,2}, {-2,0}, {-2,1}, {-2,2}, {-1,2} }},
		{{ {-1,0}, {-1,1} }}
	}},

	// 索引10 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1} }},
		{{ {2,-1}, {2,0}, {2,1}, {3,-1}, {3,0}, {3,1} }},
		{{ {1,-1}, {1,0}, {1,1} }}
	}},

	// 索引11 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}}},
		{{ {2,-1}, {2,0}, {2,1} }},
		{{ {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }}
	}},

	// 索引12（原缺失索引）
	{{
		{{ {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,0} }},
		{{ {-2,-2}, {-1,-2}, {-1,-1}, {0,-2}, {1,-2}, {1,-1} }},
		{{ {-1,-1}, {0,-1}, {1,-1} }}
	}},

	// 索引13 
	{{
		{{ {1,-1}, {1,0}, {1,1} }},
		{{ {-2,-1}, {-2,0}, {-2,1} }},
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1} }}
	}},

	// 索引14 
	{{
		{{ {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-3,-1}, {-3,0}, {-3,1}, {-2,-1}, {-2,0}, {-2,1} }},
		{{ {-1,-1}, {-1,0}, {-1,1} }}
	}},

	// 索引15 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,1} }},
		{{ {1,-2}, {2,-2}, {2,-1}, {2,0}, {3,-2}, {3,-1}, {3,0} }},
		{{ {1,-1}, {1,0} }}
	}},

	// 索引16 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,1}, {1,1} }},
		{{ {0,-2}, {1,-2}, {2,-2}, {2,-1}, {2,0} }},
		{{ {0,-1}, {0,0}, {1,-1}, {1,0} }}
	}},

	// 索引17 
	{{
		{{ {-1,1}, {0,1}, {1,1} }},
		{{ {-1,-2}, {0,-2}, {1,-2} }},
		{{ {-1,-1}, {-1,0}, {0,-1}, {0,0}, {1,-1}, {1,0} }}
	}},

	// 索引18 
	{{
		{{ {-1,1}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-2,-2}, {-2,-1}, {-2,0}, {-1,-2}, {0,-2} }},
		{{ {-1,-1}, {-1,0}, {0,-1}, {0,0} }}
	}},

	// 索引19 
	{{
		{{ {-1,1}, {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-3,-2}, {-3,-1}, {-3,0}, {-2,-2}, {-2,-1}, {-2,0}, {-1,-2} }},
		{{ {-1,-1}, {-1,0} }}
	}},

	// 索引20 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,0}, {1,1} }},
		{{ {1,-3}, {1,-2}, {2,-3}, {2,-2}, {2,-1}, {3,-3}, {3,-2}, {3,-1} }},
		{{ {1,-1} }}
	}},

	// 索引21 
	{{
		{{ {-1,-1}, {-1,0}, {-1,1}, {0,0}, {0,1}, {1,0}, {1,1} }},
		{{ {0,-3}, {0,-2}, {1,-3}, {1,-2}, {2,-3}, {2,-2}, {2,-1} }},
		{{ {0,-1}, {1,-1} }}
	}},

	// 索引22 
	{{
		{{ {-1,0}, {-1,1}, {0,0}, {0,1}, {1,0}, {1,1} }},
		{{ {-1,-3}, {-1,-2}, {0,-3}, {0,-2}, {1,-3}, {1,-2} }},
		{{ {-1,-1}, {0,-1}, {1,-1} }}
	}},

	// 索引23 
	{{
		{{ {-1,0}, {-1,1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-2,-3}, {-2,-2}, {-2,-1}, {-1,-3}, {-1,-2}, {0,-3}, {0,-2} }},
		{{ {-1,-1}, {0,-1} }}
	}},

	// 索引24 
	{{
		{{ {-1,0}, {-1,1}, {0,-1}, {0,0}, {0,1}, {1,-1}, {1,0}, {1,1} }},
		{{ {-3,-3}, {-3,-2}, {-3,-1}, {-2,-3}, {-2,-2}, {-2,-1}, {-1,-3}, {-1,-2} }},
		{{ {-1,-1} }}
	}}
} };
